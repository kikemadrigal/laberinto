10 rem ******************************
20 rem Program 
30 rem autor:   
40 rem ******************************
50 cls:defint a-z: open"grp:"as#1
60 'ON STRIG GOSUB 1530
70 sprite on:ON SPRITE gosub 1900
80 gosub 8000
90 gosub 8210
100 gosub 8100
120 gosub 5000
130 gosub 6000
140 gosub 6100:ex(1)=8*12:ey(1)=6*20:gosub 6100:ex(2)=8*5:ey(2)=8*2:gosub 6100:ex(3)=8*7:ey(3)=8*5
    400 gosub 1260
    410 'gosub 4000
    430 gosub 1760
    440 gosub 1400
500 goto 400 
1260 '' <<<< INPUT SYSTEM >>>>
    1270 ST=STICK(0) OR STICK(1) OR STICK(2)
    1280 TG=STRIG(0) OR STRIG(1) OR STRIG(2)
    1290 I$=INKEY$
    1300 xp=x:yp=y
    1310 'cp=x/8: fp=y/8
    1320 IF ST=7 THEN x=x-pv:pp=1
    1330 IF ST=3 THEN x=x+pv:pp=2
    1340 IF ST=1 THEN y=y-pv:pp=0
    1350 IF ST=5 THEN y=y+pv:pp=3
    1370 if x<=0 then x=xp
    1380 if y<=0 then y=yp
    1385 if y+ph>176 then y=yp
    1390 if x+pw>252 then x=xp
1395 RETURN
1400 '' <<< RENDER SYSTEM >>>>
    1420 PUT SPRITE 0,(x,y),2,pp
    1430 'for i=0 to en=en-1
        1440 PUT SPRITE 5,(ex(1),ey(1)),10,5
        1450 PUT SPRITE 6,(ex(2),ey(2)),10,5
        1460 PUT SPRITE 7,(ex(3),ey(3)),10,5
    1470 'next i
    1480 if mc then locate 0,19:gosub 8100:px=8:py=16
1490 return
    1760 hl=base(5)+(y/8)*32+(x/8):a=vpeek(hl)
    1770 if a=224 then x=xp: y=yp
    1780 if a=204 then x=8*16: y=8*18:beep
    1790 if a=215 then mc=1:ms=ms+1
    1800 for i=0 to en-1
        1810 hl=base(5)+(ey(i)/8)*32+(ex(i)/8):a=vpeek(hl)
        1820 if a=224 then ev(i)=-ev(i)
        1830 ex(i)=ex(i)+ev(i)
    1840 next i
1850 return
    1900 if pe=0 then gosub 5000
    1910 pe=pe-1:gosub 3000:x=8:y=16
1990 return
    3000 locate 0,0: print "Level "ms", "fre(0)", Vidas:"pe
3010 return
    4000 'pc=x/8:pf=y/8
    4010 'if pc <0 then pc=0:if pf <0 then pf=0:if cp <0 then cp=0:if fp <0 then fp=0
    4020 'hl=base(5)+(y/8)*32+(x/8):a=vpeek(hl)
    4030  locate 0,21: print "en: "en", ex "ex(1)", ey: "ey(1)", ev"ev(1)
    4040 'locate 0,20: print "fp:"fp", cp:"cp",ar:"m(fp,cp,ms)"                  "
    4050 'locate 0,21: print "pf:"pf", pc:"pc",ar:"m(pf,pc,ms)"                  "
4060 return
    5000 x=8:y=16:xp=0:yp=0:pw=8:ph=8:pv=8:pe=10
5020 return
    6000 en=1
    6010 ex(0)=0:ey(0)=0:ev(0)=8:ew(0)=8:eh(0)=8:es(0)=5
    6020 ea(0)=30:ed(0)=15:ee(0)=100:ef(0)=0
6030 return
    6100 'en=en+1
    6110 ex(en)=ex(0):ey(en)=ey(0):ev(en)=ev(0):ew(en)=ew(0):eh(en)=eh(0):es(en)=es(0)
    6120 ea(en)=ea(0):ed(en)=ed(0):ee(en)=ee(0):ef(en)=ef(0)
    6130 en=en+1
6140 return
    8000 ms=0:mm=1:mc=0:tn=-1
    8010 dim m(23,31,mm-1)
8020 return
    8100 cls:mc=0
    8110 if ms>=mm then ms=0
    8115 _TURBO ON (tn,m(),ms,mm)
    8120 for i=0 to mm-1
        8130 for f=0 to 21
            8140 for c=0 to 31
                8150 tn= m(f,c,ms)
                8160 if tn=0 then locate c, f:print chr$(215)
                8165 if tn=1 then locate c, f:print chr$(224)
                8170 if tn=2 then locate c, f:print chr$(204)
            8175 next c
        8180 next f
    8185 next i
    8190  _TURBO off
    8195 gosub 3000
8200 return
    8210 for i=0 to mm-1
        8215 for f=0 to 21
            8220 for c=0 to 31
                8230 read a$ 
                8240 m(f,c,i)=VAL(a$)
            8250 next c
        8260 next f
    8270 next i
8280 return
10010 data -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1
10020 data -1,-1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1
10030 data 1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1
10040 data 1,-1,-1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
10050 data 1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1
10060 data 1,-1,-1,1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,-1,-1,-1,1
10070 data 1,-1,-1,1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1
10080 data 1,-1,-1,1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1
10090 data 1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,1,-1,-1,1
10100 data 1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,2,2,1,-1,-1,1,-1,-1,1,-1,-1,1
10110 data 1,-1,-1,1,-1,-1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,2,2,1,-1,-1,1,-1,-1,1,-1,-1,1
10120 data 1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,1,-1,-1,1
10130 data 1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1,-1,-1,1
10140 data 1,-1,-1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,1,-1,-1,1
10150 data 1,-1,-1,1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1
10160 data 1,-1,-1,1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,1
10170 data 1,1,1,1,-1,-1,1,-1,-1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,1
10180 data 1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,1,2,2,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1
10190 data 1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,1,2,2,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,1
10200 data 1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,-1,-1,1
10210 data 1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1
10220 data 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
